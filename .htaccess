# Základní .htaccess pro SPA aplikaci
RewriteEngine On

# MIME typy
AddType application/javascript .js
AddType text/css .css

# Zajistit, že PHP soubory se zpracovávají jako PHP
AddType application/x-httpd-php .php
AddHandler application/x-httpd-php .php

# Povolit přístup k VŠEM PHP souborům bez autentifikace
<Files "*.php">
    Allow from all
    Require all granted
</Files>

# Povolit přístup k debug souborům bez autentifikace
<Files "debug-*.php">
    Allow from all
    Require all granted
</Files>

<Files "debug-*.html">
    Allow from all
    Require all granted
</Files>

<Files "quick-debug-test.php">
    Allow from all
    Require all granted
</Files>

# Explicitní povolení pro kritické PHP soubory
<Files "test.php">
    Allow from all
    Require all granted
</Files>

<Files "auth.php">
    Allow from all
    Require all granted
</Files>

# CORS pro debug
<IfModule mod_headers.c>
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "POST, GET, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type"
</IfModule>

# SPA routing - přesměrování všech requestů na index.html (kromě .php souborů)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !\.php$
RewriteRule . /index.html [L]

# Základní zabezpečení
<Files ".env">
    Order allow,deny
    Deny from all
</Files>